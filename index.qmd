---
title: "Utiliser OpenStreetMap avec R"
subtitle: "Goupe ElementR"
lang: "fr"
author: "Ronan Ysebaert, Louis Laurian, Timothée Giraud, Matthieu Viry"
date: "2025-05-13"
mainfont: Liberation Sans
monofont: Liberation Sans
date-format: "DD MMM YYYY"
format:
  revealjs: 
    theme: [default,mytheme.scss]
self-contained: true
title-slide-attributes: 
      data-background-image: utils/bg_first.png
      data-background-size: cover
editor_options: 
  chunk_output_type: console
---

# OpenStreetMap en quelques mots

## Bref historique et grandes spécificités

::: {.center-xy}
::: columns

:::: {.column width="50"}
- Un projet de cartographie collaborative en ligne
- Inspiré de Wikipedia et la prédominance de données géographiques propriétaires
- Courant du libre (licence Open Data Commons Open Database License)
- Contribution par les utilisateurs
:::: 

:::: {.column width="50%"}
**Quelques dates clé**

- 2004 : création par Steve Coast (University College Londres)
- 2006 : création de la fondation OpenStreetMap (infrastructure matérielle + cadre juridique)
- 2010 : import du cadastre français dans un format vectoriel
- 2011 : création de l'association OpenStreetMap France
:::: 
:::

:::



## Utilisateurs et contributeurs

- 38 % des utilisateurs inscrits ont modifié un objet et 38 % ont contribué de manière significative (Zipf, 2012). 
- Une enquête menée de 2014 à 2017 a révélé que le contributeur type est masculin et trentenaire (moyenne d'âge 38 ans), doté d'un niveau de diplôme élevé, plutôt cadre et « évoluant entre informatique et territoires », avec un « intérêt marqué et renforcé pour les cartes (Noucher, 2018)


::: columns

:::: {.column width="50"}
[Utilisateures](img/registered_members.png)
:::: 

:::: {.column width="50%"}
[Membres actifs](img/daily_active_members.png)
:::: 
:::



## Les données OSM par pays

```{r}
library(rnaturalearth)
library(mapsf)
library(sf)

# Import data
world <- ne_countries(scale = "small") 
df <- read.csv("docs/geofabrik_size_country.csv", dec = ",")

# Join and data handling
world <- merge(world[,c("adm0_a3_fr", "pop_est")], df, by.x = "adm0_a3_fr", by.y = "adm0_a3", all.x = TRUE)
world <- world[world$adm0_a3_fr  != "ATA",]
world <- st_transform(world, "+proj=bertin1953")

world <- aggregate(world[,c("pop_est", "Size_2025_OSM")], by = list(world$adm0_a3_fr),
                   FUN = sum)
world$dens <- world$Size_2025_OSM / (world$pop_est/1000000)
world <- world[order(world$dens, decreasing = TRUE),]

# Map
mf_map(world, col = "white")
mf_map(world, var = c("Size_2025_OSM", "dens"), type = "prop_choro", pal = "YlOrRd", inches = .2,
       leg_title = c("Poids du fichier\nosm.pbf (2025, Mo)", "Mo/Million d'habitants"), nbreaks = 5,
       leg_val_rnd = c(0,0))
mf_title("Masse de données OpenStreetMap à travers le monde")
mf_credits("Source : Geofabrik, 2025")
```

- France = 4.4 GB
- Top 10 (masse de donnée / million hab) : Féroé, Groenland, Norvège, Islande, Suède, Canada, Finland, Autriche, Estonie, Rep Tchèque




## Utilisateurs et contributeurs

gif (source https://www.lemonde.fr/blog/data/tag/openstreetmap/) 


## Usages courants

- Amazon, Apple, FB, etc.
- Secteur humanitaire (CartONG, Nations Unies, Banque Mondiale, etc.). Cf https://www.missingmaps.org/
- Collectivités (exemple GRANULAR mise en place service partagé de données à l'échelle inter-communale sur la gestion des déchets).
- Agences de transport ([SNCF](https://peertube.openstreetmap.fr/w/1Bi7aeGiRFWAXhU61a8gKC), Deutsche Bahn, etc.)
- SIG et logiciels associés (QGIS, ESRI)
- Medias
- Des services/outils pour le public : randonnée, tourisme/city map, etc.) 


# La base de données OpenStreetMap

## Les objets géographiques dans OSM

- nodes : un noeud qui contient des données avec sa position, des métadonnées (dernières contributions, modifications) et éventuellement des *tags* sous forme de pairs *key-value*.
- way : une ligne avec au minimum 2 nodes. Peut se référer aussi à un polygone (une ligne qui a partage son premier et dernier point)
- relation: pour regrouper des objets selon des caractéristiques communes (ligne de bus, objets inclus dans un aéroport, etc.) 

## La folksonomie OSM

- des tags, définis par des clés-valeur (key-value) pour caractériser les objets
- proposés par la communauté : évolutif, flexibles
- plusieurs tags peuvent être associés à un objet

> exemple bâtiment recherche condorcet. 
> OSM wiki pour s'y retrouver

## Les clés principales

présentation des clés principales en nb de contributions (+ types d'objets géo)

Même chose avec la clé amenity


## Précision et complétude

- Précision/justesse géométrique
- Complétude des attributs / exemple tiré de l'étude centralité
- Aspect liés à la saturation et complétude des attributs (Heidelberg Institute for Geoinformation Technology) > [Ohsome Dashboard](https://dashboard.ohsome.org/#backend=ohsomeApi&groupBy=none&time=%2F2025-02-02T12%3A00Z%2FP1M&key=natural&value=tree&types=node&measure=count) 
- [CheckAutopista](https://k1wiosm.github.io/checkautopista2/?id=16898316&lat=49.4788&lon=2.5598&z=7&view=AX)


## Les aspects récurrents

- La qualité et la complétude augmente avec le temps
- Hétérogénéité d'OSM: tags fantaisistes
- Justesse/qualité dans les zones densément peuplées plus fortes
- Réseau plutôt de bonne qualité
- Variabilité en fonction des pays


# Interroger OpenStreetMap avec R

## Logiciels qui utilisent / diffusent des données OSM

- OverpassTurbo : explorer / télécharger rapidement (exemple cours Merickskay 
- Geofabrik : télécharger massivement
- OSRM/Valhalla: routage
- nominatim : géocodage
- stadia/thunderforest/CARTO
- contribuer ! OSMid Be careful bonnes pratiques ! 


## Les packages R de référence

Import de données:  osmdata, osmextract
routage: osrm, [valh NEW!]
carte interactive: leaflet, mapview
habillage carto: maptiles, maposm
géocodage: tidygeocoder, nominatim

> exemple appliqué à l'environnement géo de Condorcet où on recherche l'indien le plus proche à pieds, qu'on déroule simplement ?


## Le cas des requêtes massives

- osmextract plutôt qu'osmdata
- mise en place d'un serveur de routage [Tim] 


# OSM : un point de départ

Exemple de réalisations du lavbo

## Combinaison de sources hétérogènes et complétudes des données

- Combiner des données institutionnelles (GRANULAR / aspects complétude) [Louis ou Ronan]
- Analyse de complétude / points (GRANULAR / CGET) [Ronan]
- Comparaison des temps routiers / preuves de covoiturage [Louis]
- Habillage de cartes pour mise en situation locale: Airbnb template locaux [Ronan]

## Du point à la surface

- lissages gaussiens : diff de potentiels étude CGET [Ronan]
- KDE / restos à Paris [Tim].

## Accessibilité

- Indicateurs d'accessibilité GRANULAR [Louis]
- Porosité des points de passage frontaliers [Matthieu]
- Accès aux maternités [Ronan]
- Voisinage fonctionnel: potentiel de pop euclidien / par la route [Tim]
- Accès aux salles de grimpe en vélo [Ronan] / aspect contrib' en plus


# Bibliographie (sélective)

## Bibliographie (sélective)


::: {.small}

**Présentation d'OSM**

- [Viry, Généralités autours d'OSM](https://hal.science/hal-03589030v1/file/TR_05_completude_osm.pdf)

**Réflexion sur OSM, ses usages ses évolutions**

- https://journals.openedition.org/netcom/2635 OSM Science—The Academic Study of the OpenStreetMap Project, Data, Contributors, Community, and Applications : https://www.mdpi.com/2220-9964/11/4/230
- Analysing the Impact of Large Data Imports in OpenStreetMap : https://www.mdpi.com/2220-9964/10/8/528
- Bridges and Barriers: An Exploration of Engagements of the Research Community with the OpenStreetMap Community : https://www.mdpi.com/2220-9964/11/1/54

**Complétude**

- https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0180698
- https://onlinelibrary.wiley.com/doi/10.1111/j.1467-9671.2010.01203.x (fr)
- https://www.tandfonline.com/doi/full/10.1080/10095020.2022.2124127
- Analyzing the Contributor Activity of a Volunteered Geographic Information Project — The Case of OpenStreetMap (https://www.mdpi.com/2220-9964/1/2/146)

:::


## remind for layout

::: {.small}
toto
:::

## layout


::: columns
::: {.column width="50%"}
super colonne
:::

::: {.column .v-center-container width="50%"}

super autre colonne
:::

:::


## {background-image="utils/bg_last.png"}

::: columns

::: {.column width="45%"}
<br><br><br><br><br>

::: {.big}
Merci ! 
:::

::: {.small}

ronan.ysebaert\@cnrs.fr\
louis.laurian\@cnrs.fr\
timothee.giraud\@cnrs.fr\
matthieu.viry\@cnrs.fr\

::: 

:::

:::

::: {.column width="55%"}

:::
